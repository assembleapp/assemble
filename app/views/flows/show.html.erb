<h1>
  <%= link_to @flow.user.username, [@flow.user, :flows] %>
  /
  <%= @flow.name %>
</h1>

<div class="layout-column-left">
  <%= highlight_flow(@flow) %>

  <%= link_to "Edit", [:edit, @flow.user, @flow] %>
</div>

<div class="layout-column-right">
  <div class="section">
    <h2>Input Schema</h2>
    <%= highlight_json(@flow.schema) %>
  </div>

  <div class="section">
    <h2>Environment Variables</h2>

    <div class="section-description">
      These variables are kept secret from everyone else,
      but you can use them in your script through <code>Flow.env</code>.
    </div>

    <ul>
      <% @flow.env_variables.each do |env| %>
        <li>
          <code><%= env.key %></code> = <%= "*" * 8 %>
          <%= link_to "[X]", [@flow.user, @flow, env], method: :delete %>
        </li>
      <% end %>
    </ul>

    <%= link_to "+ Add Variable", [:new, @flow.user, @flow, :env_variable] %>
  </div>

  <div class="section">
    <h3>Runs</h3>

    <% if @flow.runs.any? %>
      <%= render @flow.runs %>
    <% else %>
      <div class="section-description">
        <p>
        This flow has not been run yet.
        </p>

        <p>
        You can run it by passing in input from another flow.
        For example, to trigger it from Javascript try:
        </p>

        <pre><code>Flow.trigger("<%= "#{@flow.user.username}/#{@flow.name}"%>", { "data": "goes here" })</code></pre>

        <p>
        You can also set up this flow to run in response to online actions.
        <%= link_to "Look through our collection of triggers", triggers_path %>,
        and then <%= link_to "edit this flow", [:edit, @flow.user, @flow] %>
        to subscribe to a trigger.
        </p>
      </div>
    <% end %>
  </div>
